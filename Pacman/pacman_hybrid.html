<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pacman Hybrid — Somnia</title>

  <!-- NOTE: pacman.css di folder yang sama -->
  <link rel="stylesheet" href="pacman.css" />
</head>
<body>

  <div class="game-wrap">
    <div id="score">0</div>

    <button id="start-button">
      Start Game (bayar 0.01 STT)
    </button>

    <div id="grid-container" class="grid"></div>

    <div id="dpad">
      <button id="btn-up">▲</button>
      <div style="display:flex; gap:10px;">
        <button id="btn-left">◀</button>
        <button id="btn-right">▶</button>
      </div>
      <button id="btn-down">▼</button>
    </div>
  </div>

  <!-- script game -->
  <script src="pacman_hybrid.js"></script>

  <!-- safe postMessage debug handler: show messages from parent -->
  <script>
    window.addEventListener('message', (ev) => {
      // jangan percayai sumber tak dikenal; di dev kita terima semua untuk debug
      const d = ev.data || {};
      if (d.type === 'START_GAME_RESULT') {
        if (d.success) {
          // parent konfirmasi tx sukses -> mulai game sudah di-handle oleh script game start (fallback)
          console.log('[iframe] START_GAME_RESULT success');
        } else {
          alert('Transaksi Start Game gagal / dibatalkan.');
        }
      }
    });
  </script>

</body>
</html>
